# ç®€åŒ–ç‰ˆå°è®°åˆ¤æ–­è¯­æ³•ç¤ºä¾‹
# å±•ç¤ºæ–°å¢çš„ selfHasMark å’Œ opponentHasMark condition

# ç¤ºä¾‹1ï¼šä½¿ç”¨æ–°çš„ç®€åŒ–è¯­æ³• - è‡ªå·±æœ‰æŒ‡å®šå°è®°æ—¶è§¦å‘
- id: effect_simplified_self_has_mark
  trigger: OnSkillUse
  priority: 100
  apply:
    type: dealDamage
    target: { base: target }
    value: 50
  condition:
    # ğŸ†• æ–°çš„ç®€åŒ–è¯­æ³•ï¼šç›´æ¥åˆ¤æ–­è‡ªå·±æ˜¯å¦æœ‰æŒ‡å®šå°è®°
    type: selfHasMark
    baseId: mark_liuxie

# ç¤ºä¾‹2ï¼šä½¿ç”¨æ–°çš„ç®€åŒ–è¯­æ³• - å¯¹æ‰‹æœ‰æŒ‡å®šå°è®°æ—¶è§¦å‘
- id: effect_simplified_opponent_has_mark
  trigger: OnSkillUse
  priority: 100
  apply:
    type: setSureHit
    target: useSkillContext
    priority: 2
  condition:
    # ğŸ†• æ–°çš„ç®€åŒ–è¯­æ³•ï¼šç›´æ¥åˆ¤æ–­å¯¹æ‰‹æ˜¯å¦æœ‰æŒ‡å®šå°è®°
    type: opponentHasMark
    baseId: mark_yinghua

# ç¤ºä¾‹3ï¼šç»„åˆä½¿ç”¨ - è‡ªå·±æœ‰å°è®°Aä¸”å¯¹æ‰‹æœ‰å°è®°Bæ—¶è§¦å‘
- id: effect_combined_mark_check
  trigger: OnDamage
  priority: 100
  apply:
    type: addMark
    target: { base: target }
    mark: { type: 'entity:baseMark', value: 'mark_zhongdu' }
  condition:
    type: every
    conditions:
      - type: selfHasMark
        baseId: mark_nengliang
      - type: opponentHasMark
        baseId: mark_ruodianjihao

# ç¤ºä¾‹4ï¼šä½¿ç”¨åŠ¨æ€å€¼ - æ ¹æ®æŠ€èƒ½baseIdåˆ¤æ–­å°è®°
- id: effect_dynamic_mark_check
  trigger: OnSkillUse
  priority: 100
  apply:
    type: heal
    target: { base: self }
    value: 30
  condition:
    type: selfHasMark
    baseId:
      type: dynamic
      selector:
        base: useSkillContext
        chain:
          - type: selectPath
            arg: skill
          - type: selectPath
            arg: baseId
          - type: replace
            arg: 'skill_'
            with: 'mark_'

# å¯¹æ¯”ï¼šæ—§çš„å¤æ‚è¯­æ³• vs æ–°çš„ç®€åŒ–è¯­æ³•

# æ—§è¯­æ³•ï¼šåˆ¤æ–­è‡ªå·±æ˜¯å¦æœ‰æµè¡€å°è®°ï¼ˆå¤æ‚ï¼‰
- id: effect_old_syntax_self_has_mark
  trigger: OnSkillUse
  priority: 100
  apply:
    type: dealDamage
    target: { base: target }
    value:
      type: dynamic
      selector:
        base: selfMarks
        chain:
          - type: whereAttr
            extractor:
              type: base
              arg: baseId
            evaluator:
              type: same
              value: mark_liuxie
          - type: select
            arg:
              type: base
              arg: stack
          - type: multiply
            arg: 2
  condition:
    type: evaluate
    target:
      base: selfMarks
      chain:
        - type: whereAttr
          extractor:
            type: base
            arg: baseId
          evaluator:
            type: same
            value: mark_liuxie
    evaluator:
      type: exist

# æ–°è¯­æ³•ï¼šåˆ¤æ–­è‡ªå·±æ˜¯å¦æœ‰æµè¡€å°è®°ï¼ˆç®€åŒ–ï¼‰
- id: effect_new_syntax_self_has_mark
  trigger: OnSkillUse
  priority: 100
  apply:
    type: dealDamage
    target: { base: target }
    value:
      type: dynamic
      selector:
        base: selfMarks
        chain:
          - type: whereAttr
            extractor:
              type: base
              arg: baseId
            evaluator:
              type: same
              value: mark_liuxie
          - type: select
            arg:
              type: base
              arg: stack
          - type: multiply
            arg: 2
  condition:
    # ğŸ‰ å¤§å¤§ç®€åŒ–äº†conditionéƒ¨åˆ†ï¼
    type: selfHasMark
    baseId: mark_liuxie

# ç¤ºä¾‹5ï¼šå¦å®šåˆ¤æ–­ - è‡ªå·±æ²¡æœ‰æŒ‡å®šå°è®°æ—¶è§¦å‘
- id: effect_self_not_has_mark
  trigger: OnSkillUse
  priority: 100
  apply:
    type: addMark
    target: { base: self }
    mark: { type: 'entity:baseMark', value: 'mark_nengliang' }
  condition:
    type: not
    condition:
      type: selfHasMark
      baseId: mark_nengliang

# ç¤ºä¾‹6ï¼šå¤šé‡æ¡ä»¶ - å¤æ‚çš„å°è®°åˆ¤æ–­é€»è¾‘
- id: effect_complex_mark_logic
  trigger: OnSkillUse
  priority: 100
  apply:
    type: dealDamage
    target: { base: target }
    value: 100
  condition:
    type: some # æ»¡è¶³ä»»ä¸€æ¡ä»¶å³å¯
    conditions:
      # æƒ…å†µ1ï¼šè‡ªå·±æœ‰èƒ½é‡å°è®°ä¸”å¯¹æ‰‹æœ‰ä¸­æ¯’å°è®°
      - type: every
        conditions:
          - type: selfHasMark
            baseId: mark_nengliang
          - type: opponentHasMark
            baseId: mark_zhongdu
      # æƒ…å†µ2ï¼šè‡ªå·±æœ‰æµè¡€å°è®°ä¸”å¯¹æ‰‹æœ‰å¼±ç‚¹å°è®°
      - type: every
        conditions:
          - type: selfHasMark
            baseId: mark_liuxie
          - type: opponentHasMark
            baseId: mark_ruodianjihao
      # æƒ…å†µ3ï¼šè‡ªå·±æœ‰æ¨±èŠ±å°è®°
      - type: selfHasMark
        baseId: mark_yinghua
